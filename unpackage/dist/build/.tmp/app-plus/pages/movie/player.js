(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/movie/player"],{"16d0":function(t,e,i){"use strict";i.r(e);var r=i("573c"),n=i("67d9");for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);i("f297");var a=i("2877"),s=Object(a["a"])(n["default"],r["a"],r["b"],!1,null,null,null);e["default"]=s.exports},"395f":function(t,e,i){"use strict";(function(t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("a34a")),o=a(i("8961"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e,i,r,n,o,a){try{var s=t[o](a),u=s.value}catch(c){return void i(c)}s.done?e(u):Promise.resolve(u).then(r,n)}function u(t){return function(){var e=this,i=arguments;return new Promise(function(r,n){var o=t.apply(e,i);function a(t){s(o,r,n,a,u,"next",t)}function u(t){s(o,r,n,a,u,"throw",t)}a(void 0)})}}var c=function(){return i.e("components/uni-notice-bar/uni-notice-bar").then(i.bind(null,"bf8c"))},l={mixins:[o.default],components:{uniNoticeBar:c},data:function(){return{vodInfo:{},vodList:[],palyerUrl:"https://cn1.download05.com/hls/20190910/dc7992f5d9b95d26ef8d2726acd71675/1568085844/index.m3u8",urlList:[],history:!1,historyJIndu:{currentTime:0,duration:0},historyData:[],playerInitialTime:0}},onLoad:function(e){this.videoContext=t.createVideoContext("myVideo"),this.getVodInfo(e.id),e.history?(console.log(r("历史数据:",e," at pages/movie/player.vue:71")),this.history=!0,this.historyData=JSON.parse(decodeURIComponent(e.history))):this.history=!1},methods:{setHistoryData:function(){var t=this.historyData;console.log(r("播放地址：",t," at pages/movie/player.vue:83")),this.vodList=this.vodList.map(function(e){return e.active=!1,t.activeAddress==e.addres&&(e.active=!0),e}),this.urlList=this.vodList.filter(function(t){return t.active})[0]||{},this.urlList.urlList=this.urlList.urlList.map(function(e){return e.active=!1,t.activeTitle==e.title&&(e.active=!0),e}),this.palyerUrl=this.historyData.activeUrl,this.playerInitialTime=t.currentTime||0,this.videoContext.play()},videoPlay:function(){this.endPlayer()},videoError:function(t){console.log(r("Error:",t," at pages/movie/player.vue:108"))},videoPause:function(t){console.log(r("Pause:",t," at pages/movie/player.vue:112"))},videoTimeupdate:function(t){this.historyJIndu=t.detail,this.buildData(this.historyJIndu)},showMenu:function(t){var e=/m3u8/;return e.test(t.addres)},getPlayerUrl:function(){var t=u(n.default.mark(function t(e,i){var o,a;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return o={type:e,url:i.url},t.next=3,this.getRealPalyeUrl(o);case 3:a=t.sent,console.log(r(11,a," at pages/movie/player.vue:130")),this.palyerUrl=a,this.endPlayer();case 7:case"end":return t.stop()}},t,this)}));function e(e,i){return t.apply(this,arguments)}return e}(),endPlayer:function(){this.buildData(),this.videoContext.play()},buildData:function(t){var e=this,i={};this.urlList.urlList=this.urlList.urlList.map(function(t){return t.active=!1,e.palyerUrl==t.url&&(t.active=!0,i=t),t});var r=this.vodInfo,n=r.vod_id,o=r.vod_pic,a=r.vod_name,s=r.vod_director,u=r.vod_actor,c=r.vod_year,l=r.vod_score,d={activeAddress:this.urlList.addres,activeTitle:i.title,activeUrl:i.url,vod_id:n,vod_pic:o,vod_name:a,vod_director:s,vod_actor:u,vod_year:c,vod_score:l,currentTime:0,duration:0};t&&(d.currentTime=t.currentTime,d.duration=t.duration),this.setSync(d)},setSync:function(e){var i=t.getStorageSync("player:history");i||(i=[]);for(var n=0;n<i.length;n++)if(i[n].vod_id===e.vod_id){i.splice(n,1);break}i.unshift(e),t.setStorage({key:"player:history",data:i,success:function(){console.log(r("player 缓存成功"," at pages/movie/player.vue:194"))}})},getVodInfo:function(){var e=u(n.default.mark(function e(i){var o;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post("movie/dyController/getVodInfo",{id:i});case 2:o=e.sent,o.data&&o.data.success?(this.vodInfo=o.data.result[0],t.setNavigationBarTitle({title:this.vodInfo.vod_name}),this.vodList=this.setVodList(this.vodInfo),this.urlList=this.vodList.filter(function(t){return t.active})[0]||{},console.log(r("urlList",this.urlList," at pages/movie/player.vue:210")),this.palyerUrl=this.urlList.urlList[0].url,this.history&&this.setHistoryData()):console.log(r("请求错误"," at pages/movie/player.vue:214"));case 4:case"end":return e.stop()}},e,this)}));function i(t){return e.apply(this,arguments)}return i}(),setActive:function(t){this.vodList=this.vodList.map(function(e){return e.active=!1,t.addres==e.addres&&(e.active=!0),e}),this.urlList=this.vodList.filter(function(t){return t.active})[0]||{}},toPlayer:function(){t.navigateTo({url:"/pages/movie/player"})}}};e.default=l}).call(this,i("6e42")["default"],i("0de9")["default"])},"573c":function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement;t._self._c},n=[];i.d(e,"a",function(){return r}),i.d(e,"b",function(){return n})},6220:function(t,e,i){"use strict";(function(t){i("6bb2"),i("921b");r(i("66fd"));var e=r(i("16d0"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])},"67d9":function(t,e,i){"use strict";i.r(e);var r=i("395f"),n=i.n(r);for(var o in r)"default"!==o&&function(t){i.d(e,t,function(){return r[t]})}(o);e["default"]=n.a},cba6:function(t,e,i){},f297:function(t,e,i){"use strict";var r=i("cba6"),n=i.n(r);n.a}},[["6220","common/runtime","common/vendor"]]]);